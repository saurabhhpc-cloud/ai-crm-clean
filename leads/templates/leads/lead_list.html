{% extends 'leads/base.html' %}
{% block content %}

<h2 class="mb-3">Leads</h2>

<form method="get" class="mb-3">
<div class="input-group">
<input type="text" name="q" placeholder="Search..." class="form-control">
<button class="btn btn-primary">Search</button>
</div>
</form>

<div class="card shadow">
<div class="card-body table-responsive">

<table class="table">
<thead>
<tr>
<th>Name</th>
<th>Score</th>
<th>Quality</th>
<th>Status</th>
<th>Assign</th>
<th>Action</th>
</tr>
</thead>
<tbody>

{% for lead in leads %}
<tr>
<td>{{ lead.name }}</td>
<td>{{ lead.lead_score }}</td>
<td>{{ lead.lead_quality }}</td>
<td>{{ lead.crm_status }}</td>
<td>{{ lead.assigned_to }}</td>
<td>
<form method="post" action="{% url 'update_status' lead.id %}">
{% csrf_token %}
<select name="status" class="form-select form-select-sm mb-1">
<option value="new">New</option>
<option value="contacted">Contacted</option>
<option value="followup">Follow-up</option>
<option value="converted">Converted</option>
<option value="lost">Lost</option>
</select>

<select name="assigned_to" class="form-select form-select-sm mb-1">
<option value="">Unassigned</option>
{% for user in users %}
<option value="{{ user.id }}">{{ user.username }}</option>
{% endfor %}
</select>

<button class="btn btn-sm btn-primary">Update</button>
</form>
</td>
</tr>
{% endfor %}

</tbody>
</table>

<div class="mt-3">
{% if leads.has_previous %}
<a href="?page={{ leads.previous_page_number }}" class="btn btn-sm btn-outline-primary">Previous</a>
{% endif %}

<span class="mx-2">Page {{ leads.number }} of {{ leads.paginator.num_pages }}</span>

{% if leads.has_next %}
<a href="?page={{ leads.next_page_number }}" class="btn btn-sm btn-outline-primary">Next</a>
{% endif %}
</div>

</div>
</div>

{% endblock %}
